{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Статус заявки</h2>
<div class="card">
  <div class="card-body">
    <div class="d-flex flex-wrap justify-content-between gap-2">
      <div>
        <div class="text-secondary">Код</div>
        <div class="h4 mb-0">{{ app.public_code }}</div>
      </div>
      <div>
        <div class="text-secondary">Статус</div>
        <div class="h4 mb-0">
          {% if app.status == "queued" %}<span class="badge text-bg-warning">в очереди</span>{% endif %}
          {% if app.status == "rejected" %}<span class="badge text-bg-danger">отклонена</span>{% endif %}
          {% if app.status == "completed" %}<span class="badge text-bg-success">выполнена</span>{% endif %}
          {% if app.status not in ["queued","rejected","completed"] %}<span class="badge text-bg-secondary">{{ app.status }}</span>{% endif %}
        </div>
      </div>
    </div>

    <hr>

    <div class="row g-3">
      <div class="col-md-6">
        <div class="text-secondary">Тип</div>
        <div class="fw-semibold">{% if app.kind=="settle" %}Заселение{% else %}Переселение{% endif %}</div>
      </div>
      <div class="col-md-6">
        <div class="text-secondary">ФИО</div>
        <div class="fw-semibold">{{ app.student_name }}</div>
      </div>
      <div class="col-md-6">
        <div class="text-secondary">Группа</div>
        <div>{{ app.student_group or "—" }}</div>
      </div>
      <div class="col-md-6">
        <div class="text-secondary">Желаемая комната</div>
        <div>{{ app.desired_room or "—" }}</div>
      </div>
      <div class="col-12">
        <div class="text-secondary">Комментарий</div>
        <div>{{ app.reason or "—" }}</div>
      </div>
    </div>

    {% if app.status == "completed" and app.assigned_bed %}
      <hr>
      <div class="alert alert-success mb-0">
        Назначено место: комната {{ app.assigned_bed.room.number }}, место {{ app.assigned_bed.label }}
      </div>
    {% endif %}

    {% if app.status == "rejected" and app.admin_note %}
      <hr>
      <div class="alert alert-danger mb-0">
        Причина: {{ app.admin_note }}
      </div>
    {% endif %}
  </div>
</div>

<div class="mt-3">
  <a class="btn btn-outline-secondary" href="{{ url_for('client.status_get') }}">Проверить другой код</a>
</div>
{% endblock %}
